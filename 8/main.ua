Input  ← &fras"input"
Map    ← ⊜∘≠@\n.Input
Bounds ← △Map

▽¬∊"\n.".◴Input¤Map
◴/◇⊂♭⊞(
  ⧅<2⊚=
  □◴/◇⊂≡(
    ⊙¯,⟜:⊙¤⊸-°⊟
    □◴⊂∩(↘1⊙◌⍢(⊂+⊢,,|↧⊃(/↧≥0|/↧<Bounds)⊢))
  )
)
⧻
